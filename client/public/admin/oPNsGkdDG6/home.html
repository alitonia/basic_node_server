<html lang="en">
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="icon" href="./assets/images/favicon/favicon.ico"/>
<link rel="stylesheet" href="./assets/css/admin_login/admin_login.css">
<link rel="stylesheet" href="./assets/css/base.css">
<link rel="stylesheet" href="./assets/css/home/main.css">
<link rel="stylesheet" href="./assets/css/home/slider.css">
<link rel="stylesheet" href="./assets/css/home/promo.css">
<link rel="stylesheet" href="./assets/css/home/product_area.css">
<link rel="stylesheet" href="./assets/css/home/footer.css">
<link rel="stylesheet" href="./assets/css/about_us/about_us.css">

<script>
    const parseCookie = str => {
        if (str === '') {
            return {}
        }
        return str
            .split(';')
            .map(v => v.split('='))
            .reduce((acc, v) => {
                const key = decodeURIComponent(v[0].trim())
                acc[key] = decodeURIComponent(v[1].trim());
                return acc;
            }, {});
    }

    const structuredCookie = parseCookie(document.cookie)
    const isLogin = !!structuredCookie['admin_token']

    function parseJwt(token) {
        const base64Url = token.split('.')[1];
        const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
        const jsonPayload = decodeURIComponent(atob(base64).split('').map(function (c) {
            return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
        }).join(''));

        return JSON.parse(jsonPayload);
    }

    function deleteCookie1(path) {
        document.cookie = `admin_token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/admin`;
    }

    function logout() {
        deleteCookie1()
        window.location.href = '/'
    }


    if (!isLogin) {
        alert('not admin')
        window.location.href = '/'
    }

</script>

<head>
    <title>Admin Panel</title>
</head>

<body>

<div class="shop">
    <!-- Header -->
    <header class="header">
        <div class="grid">
            <div class="header_navbar">
                <a href="./home.html">
                    <div class="logo">
                        <img src="./assets/images/logo/logo.png" alt="logo">
                    </div>
                </a>

                <div class="menu_wrap">
                    <div class="main_menu">
                        <ul class="menu_list">
                            <li class="menu_item">
                                <a class="admin-panel-link link" href="./home.html">ADMIN PANEL</a>
                            </li>
                            <li class="menu_item men">
                                <a class="orders-link link" href="./orders.html">ORDERS</a>
                            </li>
                            <li class="menu_item women">
                                <a class="products-link link" href="./products.html">PRODUCTS</a>
                            </li>
                            <li class="menu_item">
                                <a class="categories-link link" href="./categories.html">CATEGORIES</a>
                            </li>
                            <li class="menu_item">
                                <a class="customers-link link" href="./customers">CUSTOMERS</a>
                            </li>
                            <!--                            <li class="menu_item cart_button">-->
                            <!--                                <a href="./cart_page.html">CART</a>-->
                            <!--                            </li>-->
                            <li class="menu_item">
                                <a class="logout-link link" href="#" onclick="logout()" style="color: #558776">LOG
                                    OUT</a>
                            </li>
                        </ul>
                    </div>

                </div>

            </div>
        </div>
    </header>
</div>

<div class="main-config">
    <h3 class="welcome">Welcome </h3>
</div>


<script>
    const info = parseJwt(structuredCookie['admin_token'])
    const name = info.user.name
    console.log(info, name)

    document.querySelectorAll('.welcome').forEach(e => {
        e.innerText = `Welcome ${name}` || 'Welcome admin'
    })
</script>

</body>

<style>
    .main-config {
        height: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .welcome {
        font-size: 30px;
        margin-top: -20%;
    }
</style>

</html>